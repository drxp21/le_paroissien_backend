import{T as M,d as y,q as P,o as m,c as I,w as g,b as a,u as l,Z as E,a as e,t as f,e as _,f as j,g as v,m as V,h as Q,F as O,i as D,p as U,v as A,s as Z,n as G}from"./app-be585e11.js";import{_ as H}from"./AppLayout-c5d08940.js";import{_ as $}from"./PrimaryButton-14ec9cf1.js";import{P as J}from"./PencilOutline-6dc69b0c.js";import{_ as q}from"./Modal-184ea046.js";import{_ as d}from"./InputLabel-bdd90b42.js";import{_ as x,a as u}from"./TextInput-149e0e80.js";import{C as T,r as K}from"./chart-c2ba7900.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./Banner-ae30a9cc.js";const W={class:"px-20 py-10"},X={class:"flex justify-between gap-10 mt-10"},Y={class:"flex flex-col gap-3 float-right"},ee={class:"text-xl font-semibold"},te=e("span",{class:"mt-1 text-lg"},"Déscription: ",-1),se={class:"flex"},le=["src"],oe={class:"grid grid-cols-2 mt-10"},ae={key:0,id:"collecteChart",class:"col-span-1"},ne={class:"text-end flex flex-col gap-3 col-span-1"},ie={class:"text-lg font-semibold"},re={class:"text-lg font-semibold"},de={class:"w-full"},ue={class:"mt-10"},ce={class:"text-lg font-semibold mb-4 flex justify-between"},me=e("li",{class:"bg-[#cecece] rounded-t-lg py-3 flex justify-evenly items-center text-sm font-medium text-start"},[e("span",{class:"flex-[1.2] pl-3"}," Auteur "),e("span",{class:"flex-[1.2] pl-3"}," Montant "),e("span",{class:"flex-[1.2] pl-3"}," Intention "),e("span",{class:"flex-[1.2] pl-3"}," Donné le: ")],-1),fe={class:"flex-[1.2] pl-3"},pe={class:"flex-[1.2] pl-3 text-green-700"},be={class:"flex-[1.2] pl-3"},ge={class:"flex-[1.2] pl-3"},_e={key:1,class:"bg-[#b7b7b7] rounded-b-lg py-3 flex justify-evenly items-center text-sm font-medium text-start"},ve=e("span",{class:"text-2xl font-medium"},"Supprimer la collecte ",-1),xe=e("div",{class:"mt-4"}," Vous allez supprimer la collecte et toutes les données qui y sont liées ! ",-1),he={class:"mt-4"},we={class:"inline-flex items-center px-4 py-2 bg-red-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-red-700 focus:bg-red-700 active:bg-red-900 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition ease-in-out duration-150"},ye={key:0,style:{"border-top-color":"transparent"},class:"ml-2 w-3 h-3 border-2 border-white border-solid rounded-full animate-spin bg-red-600"},Ve=["onSubmit"],Ce=e("span",{class:"text-2xl font-medium"},"Renseigner un don physique",-1),ke={class:"mt-4"},Me={class:"mt-4"},je={class:"mt-4"},De=["onSubmit"],Ue=e("span",{class:"text-2xl font-medium"},"Modifier la collecte de fonds",-1),$e={class:"mt-4"},qe={class:"mt-4"},Se={class:"mt-4"},Re={class:"mt-4"},Fe={class:"mt-4"},Ie={class:"mt-4"},Ae={class:"mt-4"},Te=e("div",{class:"mt-2"},[e("label",{class:"border font-medium text-sm flex items-center px-3 py-2.5 rounded-lg mt-0.5 shadow-lg",for:"editCove",role:"button"}," Changer l'image de couverture ")],-1),ze={class:"flex items-center mt-2"},Be=["src"],Ne={class:"mt-4"},Le=e("option",{value:!0},"Tout le monde",-1),Pe=e("option",{value:!1},"Mes paroissiens",-1),Ee={class:"mt-4"},Qe={key:0,style:{"border-top-color":"transparent"},class:"ml-2 w-3 h-3 border-2 border-white border-solid rounded-full animate-spin"},tt={__name:"CollecteDetails",props:{collecte:""},setup(i){var R;const n=i,o=M({id:"",titre:"",description:"",minimum:"0",date_debut:"",date_cloture:"",objectif:"",toutlemonde:"",couverture:""}),c=M({montant:"",auteur:"",intention:"",collecte_id:n.collecte.id});y([]);let C=y(!1),p=y(!1),h=y(!1),b=y(!1);const k=r=>{r+="";let t=r.split("."),s=t[0],w=t.length>1?"."+t[1]:"";for(var F=/(\d+)(\d{3})/;F.test(s);)s=s.replace(F,"$1.$2");return s+w},S=M({id:(R=n.collecte)==null?void 0:R.id}),z=r=>{let t="";r.target?t=r.target.files[0]:t=r;const s=new FileReader;s.onload=w=>{o.couverture=s.result.split(",")[1],C.value=w.target.result},s.readAsDataURL(t)},B=()=>{o.id=n.collecte.id,o.titre=n.collecte.titre,o.minimum=n.collecte.minimum,o.description=n.collecte.description,o.date_debut=n.collecte.date_debut,o.date_cloture=n.collecte.date_cloture,o.objectif=n.collecte.objectif,o.toutlemonde=n.collecte.toutlemonde!=0,o.couverture=null,h.value=!0},N=()=>{o.put(route("collectes.update",o),{onSuccess:()=>{o.reset(),C.value=!1,h.value=!1}})},L=()=>{c.post(route("collectePhysique"),{onSuccess:()=>{p.value=!1}})};return P(()=>{var r,t,s;T.register(...K),n.collecte.participations.length>0&&new T("collecteChart",{type:"doughnut",data:{labels:["Collectés","Restant"],datasets:[{data:[(r=n.collecte)==null?void 0:r.reunis,((t=n.collecte)==null?void 0:t.objectif)-((s=n.collecte)==null?void 0:s.reunis)],backgroundColor:["#507db8","#CCCCCC"]}]},options:{plugins:{title:{position:"bottom",display:!0,text:"Evolution des fonds collectés",color:"#507db8",font:{size:18,weight:"bold"},padding:{top:10}}},rotation:-90,circumference:180,animation:{duration:1500,animateScale:!0,easing:"easeInOutQuint"},responsive:!0,maintainAspectRatio:!1}})}),(r,t)=>(m(),I(H,null,{default:g(()=>[a(l(E),{title:"Collecte de fonds"}),e("div",W,[e("div",X,[e("div",Y,[e("span",ee,f(i.collecte.titre)+" "+f(i.collecte.edition),1),te,e("p",null,f(i.collecte.description),1)]),e("div",se,[e("div",{class:"m-4 flex flex-col gap-4 self-end"},[e("button",{class:"px-3 py-2 bg-teal-700 text-white rounded-md shadow-sm text-sm self-end",onClick:B}," Modifier les informations ")]),e("img",{class:"w-44 rounded-xl shadow-lg",src:i.collecte.couverture_path},null,8,le)])]),e("div",oe,[i.collecte.participations.length>0&&i.collecte.id?(m(),_("canvas",ae)):j("",!0),e("div",ne,[e("span",null,[v("Montant récolté : "),e("span",ie,f(k(i.collecte.reunis))+" cfa",1)]),e("span",null,[v("Montant restant : "),e("span",re,f(k(i.collecte.objectif))+" cfa",1)])])]),e("div",de,[e("ul",ue,[e("div",ce,[v(" Dons enregistrés "),a($,{onClick:t[0]||(t[0]=s=>V(p)?p.value=!0:p=!0)},{default:g(()=>[v(" Renseigner un don physique ")]),_:1})]),me,i.collecte.participations.length>0?(m(!0),_(O,{key:0},Q(i.collecte.participations,(s,w)=>(m(),_("li",{class:G(["py-2.5 flex justify- items-center text-sm font-medium hover:bg-[#b7b7b7]",w%2==0?"bg-white":"bg-[#cecece]"])},[e("span",fe,f(s.auteur),1),e("span",pe,f(k(s.montant))+" cfa ",1),e("span",be,f(s.intention??"---"),1),e("span",ge,f(s.created_at.split("T")[0]),1)],2))),256)):(m(),_("li",_e," Aucune participation pour le moment "))])])]),a(q,{show:l(b),onClose:t[2]||(t[2]=s=>V(b)?b.value=!1:b=!1)},{default:g(()=>[e("form",{class:"p-10",onSubmit:t[1]||(t[1]=D(()=>(l(S).delete(r.route("collectes.destroy",i.collecte.id)),V(b)?b.value=!1:b=!1),["prevent"]))},[ve,xe,e("div",he,[e("button",we,[v(" Confirmer "),l(S).processing?(m(),_("div",ye)):j("",!0)])])],32)]),_:1},8,["show"]),a(q,{show:l(p),onClose:t[6]||(t[6]=s=>V(p)?p.value=!1:p=!1)},{default:g(()=>[e("form",{class:"p-10",onSubmit:D(L,["prevent"])},[Ce,e("div",ke,[a(d,{for:"auteur",value:"Auteur (Laisser vide pour un don anonyme )"}),a(x,{id:"auteur",modelValue:l(c).auteur,"onUpdate:modelValue":t[3]||(t[3]=s=>l(c).auteur=s),type:"text",class:"mt-1 block w-full",autocomplete:"auteur"},null,8,["modelValue"]),a(u,{class:"mt-2",message:l(c).errors.auteur},null,8,["message"])]),e("div",Me,[a(d,{for:"intention",value:"Intention"}),U(e("textarea",{"onUpdate:modelValue":t[4]||(t[4]=s=>l(c).intention=s),class:"border-gray-300 focus:border-blue-500 focus:ring-blue-500 rounded-md shadow-sm w-full",rows:"3"},null,512),[[A,l(c).intention]]),a(u,{class:"mt-2",message:l(c).errors.intention},null,8,["message"])]),e("div",je,[a(d,{for:"montant",value:"Montant"}),a(x,{id:"montant",modelValue:l(c).montant,"onUpdate:modelValue":t[5]||(t[5]=s=>l(c).montant=s),type:"text",class:"mt-1 block w-full",autocomplete:"montant"},null,8,["modelValue"]),a(u,{class:"mt-2",message:l(c).errors.montant},null,8,["message"])]),a($,{class:"mt-4"},{default:g(()=>[v("Renseigner")]),_:1})],40,Ve)]),_:1},8,["show"]),a(q,{show:l(h),onClose:t[15]||(t[15]=s=>V(h)?h.value=!1:h=!1)},{default:g(()=>[e("form",{class:"p-10",onSubmit:D(N,["prevent"])},[Ue,e("div",$e,[a(d,{for:"titre",value:"Intitulé"}),a(x,{id:"titre",modelValue:l(o).titre,"onUpdate:modelValue":t[7]||(t[7]=s=>l(o).titre=s),type:"text",class:"mt-1 block w-full",required:"",autocomplete:"titre"},null,8,["modelValue"]),a(u,{class:"mt-2",message:l(o).errors.titre},null,8,["message"])]),e("div",qe,[a(d,{for:"description",value:"Détails"}),U(e("textarea",{"onUpdate:modelValue":t[8]||(t[8]=s=>l(o).description=s),class:"border-gray-300 focus:border-blue-500 focus:ring-blue-500 rounded-md shadow-sm w-full",rows:"3"},null,512),[[A,l(o).description]]),a(u,{class:"mt-2",message:l(o).errors.description},null,8,["message"])]),e("div",Se,[a(d,{for:"minimum",value:"Montant minimum de participation"}),a(x,{id:"minimum",modelValue:l(o).minimum,"onUpdate:modelValue":t[9]||(t[9]=s=>l(o).minimum=s),type:"text",class:"mt-1 block w-full",required:"",autocomplete:"minimum"},null,8,["modelValue"]),a(u,{class:"mt-2",message:l(o).errors.minimum},null,8,["message"])]),e("div",Re,[a(d,{for:"objectif",value:"Montant visé"}),a(x,{id:"objectif",modelValue:l(o).objectif,"onUpdate:modelValue":t[10]||(t[10]=s=>l(o).objectif=s),type:"text",class:"mt-1 block w-full",required:"",autocomplete:"objectif"},null,8,["modelValue"]),a(u,{class:"mt-2",message:l(o).errors.objectif},null,8,["message"])]),e("div",Fe,[a(d,{for:"date_debut",value:"Date de début de la collecte"}),a(x,{id:"date_debut",modelValue:l(o).date_debut,"onUpdate:modelValue":t[11]||(t[11]=s=>l(o).date_debut=s),type:"date",class:"mt-1 block w-full",required:"",autocomplete:"date_debut"},null,8,["modelValue"]),a(u,{class:"mt-2",message:l(o).errors.date_debut},null,8,["message"])]),e("div",Ie,[a(d,{for:"date_cloture",value:"Date de clôture de la collecte"}),a(x,{id:"date_cloture",modelValue:l(o).date_cloture,"onUpdate:modelValue":t[12]||(t[12]=s=>l(o).date_cloture=s),type:"date",class:"mt-1 block w-full",required:"",autocomplete:"date_cloture"},null,8,["modelValue"]),a(u,{class:"mt-2",message:l(o).errors.date_cloture},null,8,["message"])]),e("div",Ae,[a(d,{for:"couverture",value:"Image de couverture"}),Te,e("div",ze,[e("input",{type:"file",id:"editCove",class:"hidden",onChange:t[13]||(t[13]=s=>z(s)),accept:"image/*",name:"couverture"},null,32),l(C)?(m(),_("img",{key:0,src:l(C),class:"rounded-md my-4",width:"200"},null,8,Be)):j("",!0)]),a(u,{class:"mt-2",message:l(o).errors.couverture},null,8,["message"])]),e("div",Ne,[a(d,{for:"toutlemonde",value:"Qui peut participer ?"}),U(e("select",{required:"",class:"border-gray-300 focus:border-blue-500 focus:ring-blue-500 rounded-md shadow-sm","onUpdate:modelValue":t[14]||(t[14]=s=>l(o).toutlemonde=s)},[Le,Pe,a(u,{class:"mt-2",message:l(o).errors.toutlemonde},null,8,["message"])],512),[[Z,l(o).toutlemonde]])]),e("div",Ee,[a($,null,{default:g(()=>[v(" Modifier "),l(o).processing?(m(),_("div",Qe)):(m(),I(J,{key:1,size:20}))]),_:1})])],40,De)]),_:1},8,["show"])]),_:1}))}};export{tt as default};
