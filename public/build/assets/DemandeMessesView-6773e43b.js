import{d as g,T as L,q as Z,o as r,e as u,b as a,w as h,u as e,m as y,F as T,Z as G,a as t,g as k,f as x,h as $,p as D,v as F,s as j,c as q,i as A,O as B,n as J,t as w}from"./app-15fa8cee.js";import{_ as K}from"./AppLayout-e627d440.js";import{_ as M}from"./PrimaryButton-4c56914c.js";import{_ as p}from"./InputLabel-32e6b9c7.js";import{_ as S,a as f}from"./TextInput-6cf63914.js";import{P as Q}from"./PencilOutline-5558c032.js";import{P as W}from"./Plus-41ce2939.js";import{_ as I}from"./Modal-9c2925bc.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./Banner-3f2deb4e.js";const X=(V,U)=>{const i=[];V.forEach(C=>{const _=Object.values(C).join(",");i.push(_)});const b=i.join(`
`),c=new Blob([b],{type:"text/csv"}),m=URL.createObjectURL(c),v=document.createElement("a");v.href=m,v.download=U||"data.csv",v.style.display="none",document.body.appendChild(v),v.click(),document.body.removeChild(v),URL.revokeObjectURL(m)},Y={class:"px-20 pt-10"},ee={class:"mt-5 flex justify-center items-center gap-3"},te={class:"mt-10"},se=t("li",{class:"bg-[#cecece] rounded-t-lg py-3 flex justify-evenly items-center text-sm font-medium text-start"},[t("span",{class:"flex-[3] pl-3"},"Auteur"),t("span",{class:"flex-[3] pl-3"}," Intention"),t("span",{class:"flex-[2] pl-3"}," Date"),t("span",{class:"flex-[2] pl-3"},"Heure "),t("span",{class:"flex-[2] pl-3"},"Type "),t("span",{class:"flex-[3] pl-3"},"Action")],-1),oe={class:"flex-[3] pl-3"},ae={class:"flex-[3] pl-3"},le={class:"flex-[2] pl-3"},ne={class:"flex-[2] pl-3"},re={class:"flex-[2] pl-3"},ue={class:"flex-[3] flex gap-3 text-white justify-start"},de=["disabled","onClick"],ie={key:1,class:"bg-[#b7b7b7] rounded-b-lg py-3 flex justify-evenly items-center text-sm font-medium text-start"},me=["onSubmit"],ce=t("span",{class:"text-2xl font-medium"},"Renseigner une demande physique",-1),pe={class:"mt-4"},fe={class:"mt-4"},ve={class:"mt-4"},_e={class:"mt-4"},be=["value"],ye={class:"mt-4"},ge=t("option",{value:"Simple"},"Simple",-1),he=t("option",{value:"Neuvaine"},"Neuvaine",-1),xe=t("option",{value:"Trentaine"},"Trentaine",-1),we=[ge,he,xe],Ve=t("br",null,null,-1),ke={key:0,class:"text-slate-400"},De={key:1,class:"text-slate-400"},Se={key:2,class:"text-slate-400"},Ce={class:"mt-4"},Ue={key:0,style:{"border-top-color":"transparent"},class:"ml-2 w-3 h-3 border-2 border-white border-solid rounded-full animate-spin"},Te=["onSubmit"],je=t("span",{class:"text-2xl font-medium"},"Modifier une demande physique",-1),Me={class:"mt-4"},Ne={class:"mt-4"},Re={class:"mt-4"},Le={class:"mt-4"},$e=["value"],Fe={class:"mt-4"},qe=t("option",{value:"Simple"},"Simple",-1),Ae=t("option",{value:"Neuvaine"},"Neuvaine",-1),Be=t("option",{value:"Trentaine"},"Trentaine",-1),Ie=[qe,Ae,Be],Oe=t("br",null,null,-1),Ee={key:0,class:"text-slate-400"},He={key:1,class:"text-slate-400"},Pe={key:2,class:"text-slate-400"},ze={class:"mt-4"},Ze={key:0,style:{"border-top-color":"transparent"},class:"ml-2 w-3 h-3 border-2 border-white border-solid rounded-full animate-spin"},at={__name:"DemandeMessesView",props:{demandemesses:"",heures:""},setup(V){const U=V;let i=g(!1),b=g(!1),c=g("2023-01-01"),m=g("2024-01-01"),v=g([]),C=g([]),_=g([]),n=L({auteur:"",intention:"",date:"",heure:"",type:""}),l=L({id:"",intention:"",auteur:"",date:"",heure:"",type:""});L({id:""});const O=d=>{l.id=d.id,l.intention=d.intention,l.auteur=d.auteur=="Anonyme"?"":d.auteur,l.date=d.date,l.heure=d.heure,l.type=d.type,b.value=!0,R()},E=()=>{n.post(route("demandemesses.store"),{onSuccess:()=>{B.visit(route("demandemesses.index")),i.value=!1,n.reset()}})},H=()=>{l.auteur=l.auteur==""?"Anonyme":l.auteur,l.put(route("demandemesses.update",l),{onSuccess:()=>{B.visit(route("demandemesses.index")),l.reset(),b.value=!1}})},N=()=>{_.value=U.demandemesses.filter(d=>new Date(c.value)<=new Date(d.date)&&new Date(d.date)<=new Date(m.value))},P=()=>{for(let d of _.value)v.value.push({date:new Date(d.date).toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),intention:d.intention});X(v.value,"demandeMesses"+new Date().toLocaleDateString())},R=d=>{let o=d=="create"?new Date(n.date).getDay():new Date(l.date).getDay();o==0&&(o=7),C.value=U.heures.filter(s=>s.jour_id==o)};return Z(()=>{N()}),(d,o)=>(r(),u(T,null,[a(K,null,{default:h(()=>[a(e(G),{title:"Demandes de messe"}),t("div",Y,[a(M,{onClick:o[0]||(o[0]=s=>y(i)?i.value=!0:i=!0)},{default:h(()=>[k(" Renseigner une demande physique ")]),_:1}),V.demandemesses.length>0?(r(),u("button",{key:0,class:"inline-flex items-center px-4 py-2 bg-teal-800 border border-transparent rounded-md font-semibold text-xs text-white tracking-widest hover:bg-teal-700 focus:bg-teal-700 active:bg-teal-900 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-offset-2 transition ease-in-out duration-150",onClick:P}," Télécharger en csv ")):x("",!0),t("div",ee,[k(" Filtrer de "),a(S,{id:"date",modelValue:e(c),"onUpdate:modelValue":o[1]||(o[1]=s=>y(c)?c.value=s:c=s),type:"date",onChange:N},null,8,["modelValue"]),k(" à "),a(S,{id:"date",modelValue:e(m),"onUpdate:modelValue":o[2]||(o[2]=s=>y(m)?m.value=s:m=s),type:"date",onChange:N},null,8,["modelValue"]),a(M,{onClick:o[3]||(o[3]=()=>{y(_)?_.value=V.demandemesses:_=V.demandemesses,y(c)?c.value="2023-01-01":c="2023-01-01",y(m)?m.value="2024-01-01":m="2024-01-01"})},{default:h(()=>[k(" Supprimer le filtre ")]),_:1})]),t("ul",te,[se,e(_).length>0?(r(!0),u(T,{key:0},$(e(_),(s,z)=>(r(),u("li",{class:J(["py-2.5 flex justify- items-center text-sm font-medium hover:bg-[#b7b7b7] text-start",z%2==0?"bg-white":"bg-[#cecece]"])},[t("span",oe,w(s.auteur),1),t("span",ae,w(s.intention),1),t("span",le,w(new Date(s.date).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"})),1),t("span",ne,w(s.heure),1),t("span",re,w(s.type),1),t("div",ue,[t("button",{disabled:s.paroissien_id,class:"bg-blue-700 py-2 px-4 self-start rounded-lg disabled:bg-gray-500 disabled:cursor-not-allowed",onClick:Ge=>O(s)}," Modifier ",8,de)])],2))),256)):(r(),u("li",ie," Aucune demande de messe "))])])]),_:1}),a(I,{show:e(i),onClose:o[10]||(o[10]=s=>y(i)?i.value=!1:i=!1)},{default:h(()=>[t("form",{class:"p-10",onSubmit:A(E,["prevent"])},[ce,t("div",pe,[a(p,{for:"auteur",value:"Nom du demandeur (Laisser vide pour un don anonyme)"}),a(S,{id:"auteur",modelValue:e(n).auteur,"onUpdate:modelValue":o[4]||(o[4]=s=>e(n).auteur=s),type:"text",class:"mt-1 block w-full",autocomplete:"auteur"},null,8,["modelValue"]),a(f,{class:"mt-2",message:e(n).errors.auteur},null,8,["message"])]),t("div",fe,[a(p,{for:"intention",value:"Intention de messe"}),D(t("textarea",{"onUpdate:modelValue":o[5]||(o[5]=s=>e(n).intention=s),class:"border-gray-300 focus:border-blue-500 focus:ring-blue-500 rounded-md shadow-sm w-full",rows:"3"},null,512),[[F,e(n).intention]]),a(f,{class:"mt-2",message:e(n).errors.intention},null,8,["message"])]),t("div",ve,[a(p,{for:"date",value:"Date de la messe"}),a(S,{id:"date",modelValue:e(n).date,"onUpdate:modelValue":o[6]||(o[6]=s=>e(n).date=s),type:"date",onChange:o[7]||(o[7]=s=>R("create")),class:"mt-1 block w-full",required:"",autocomplete:"date"},null,8,["modelValue"]),a(f,{class:"mt-2",message:e(n).errors.date},null,8,["message"])]),t("div",_e,[a(p,{for:"heure",value:"Heure de la messe"}),D(t("select",{class:"border-gray-300 focus:border-blue-500 focus:ring-blue-500 rounded-md shadow-sm","onUpdate:modelValue":o[8]||(o[8]=s=>e(n).heure=s)},[(r(!0),u(T,null,$(e(C),s=>(r(),u("option",{value:s.heureDebut},w(s.heureDebut),9,be))),256))],512),[[j,e(n).heure]]),a(f,{class:"mt-2",message:e(n).errors.heure},null,8,["message"])]),t("div",ye,[a(p,{for:"type",value:"Type de demande de messe"}),D(t("select",{class:"border-gray-300 focus:border-blue-500 focus:ring-blue-500 rounded-md shadow-sm","onUpdate:modelValue":o[9]||(o[9]=s=>e(n).type=s)},we,512),[[j,e(n).type]]),a(f,{class:"mt-2",message:e(n).errors.type},null,8,["message"]),Ve,e(n).type=="Simple"?(r(),u("span",ke," 4 000 cfa")):x("",!0),e(n).type=="Neuvaine"?(r(),u("span",De," 40 000 cfa")):x("",!0),e(n).type=="Trentaine"?(r(),u("span",Se," 150 000 cfa")):x("",!0)]),t("div",Ce,[a(M,null,{default:h(()=>[k(" Valider "),e(n).processing?(r(),u("div",Ue)):(r(),q(W,{key:1,size:20}))]),_:1})])],40,me)]),_:1},8,["show"]),a(I,{show:e(b),onClose:o[17]||(o[17]=s=>y(b)?b.value=!1:b=!1)},{default:h(()=>[t("form",{class:"p-10",onSubmit:A(H,["prevent"])},[je,t("div",Me,[a(p,{for:"auteur",value:"Nom du demandeur (Laisser vide pour un don anonyme)"}),a(S,{id:"auteur",modelValue:e(l).auteur,"onUpdate:modelValue":o[11]||(o[11]=s=>e(l).auteur=s),type:"text",class:"mt-1 block w-full",autocomplete:"auteur"},null,8,["modelValue"]),a(f,{class:"mt-2",message:e(n).errors.auteur},null,8,["message"])]),t("div",Ne,[a(p,{for:"intention",value:"Intention de messe"}),D(t("textarea",{"onUpdate:modelValue":o[12]||(o[12]=s=>e(l).intention=s),class:"border-gray-300 focus:border-blue-500 focus:ring-blue-500 rounded-md shadow-sm w-full",rows:"3"},null,512),[[F,e(l).intention]]),a(f,{class:"mt-2",message:e(l).errors.intention},null,8,["message"])]),t("div",Re,[a(p,{for:"date",value:"Date de la messe"}),a(S,{id:"date",modelValue:e(l).date,"onUpdate:modelValue":o[13]||(o[13]=s=>e(l).date=s),type:"date",onChange:o[14]||(o[14]=s=>R("update")),class:"mt-1 block w-full",required:"",autocomplete:"date"},null,8,["modelValue"]),a(f,{class:"mt-2",message:e(l).errors.date},null,8,["message"])]),t("div",Le,[a(p,{for:"heure",value:"Heure de la messe"}),D(t("select",{class:"border-gray-300 focus:border-blue-500 focus:ring-blue-500 rounded-md shadow-sm","onUpdate:modelValue":o[15]||(o[15]=s=>e(l).heure=s)},[(r(!0),u(T,null,$(e(C),s=>(r(),u("option",{value:s.heureDebut},w(s.heureDebut),9,$e))),256))],512),[[j,e(l).heure]]),a(f,{class:"mt-2",message:e(l).errors.heure},null,8,["message"])]),t("div",Fe,[a(p,{for:"type",value:"Type de demande de messe"}),D(t("select",{class:"border-gray-300 focus:border-blue-500 focus:ring-blue-500 rounded-md shadow-sm","onUpdate:modelValue":o[16]||(o[16]=s=>e(l).type=s)},Ie,512),[[j,e(l).type]]),a(f,{class:"mt-2",message:e(l).errors.type},null,8,["message"]),Oe,e(l).type=="Simple"?(r(),u("span",Ee," 4000 cfa")):x("",!0),e(l).type=="Neuvaine"?(r(),u("span",He," 40000 cfa")):x("",!0),e(l).type=="Trentaine"?(r(),u("span",Pe," 150000 cfa")):x("",!0)]),t("div",ze,[a(M,null,{default:h(()=>[k(" Modifier "),e(l).processing?(r(),u("div",Ze)):(r(),q(Q,{key:1,size:20}))]),_:1})])],40,Te)]),_:1},8,["show"])],64))}};export{at as default};
