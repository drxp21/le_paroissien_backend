import{d as h,T as L,q as Z,o as r,e as u,b as a,w as x,u as s,m as y,F as T,Z as G,a as e,g as k,f as w,h as $,p as D,v as F,s as M,c as q,i as A,O as B,n as J,t as g}from"./app-be585e11.js";import{_ as K}from"./AppLayout-c5d08940.js";import{_ as j}from"./PrimaryButton-14ec9cf1.js";import{_ as p}from"./InputLabel-bdd90b42.js";import{_ as S,a as f}from"./TextInput-149e0e80.js";import{P as Q}from"./PencilOutline-6dc69b0c.js";import{P as W}from"./Plus-ca0288f5.js";import{_ as E}from"./Modal-184ea046.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./Banner-ae30a9cc.js";const X=(V,U)=>{const i=[];V.forEach(C=>{const _=Object.values(C).join(",");i.push(_)});const b=i.join(`
`),c=new Blob([b],{type:"text/csv"}),m=URL.createObjectURL(c),v=document.createElement("a");v.href=m,v.download=U||"data.csv",v.style.display="none",document.body.appendChild(v),v.click(),document.body.removeChild(v),URL.revokeObjectURL(m)},Y={class:"px-20 pt-10"},ee={class:"mt-5 flex justify-center items-center gap-3"},te={class:"mt-10"},se=e("li",{class:"bg-[#cecece] rounded-t-lg py-3 flex justify-evenly items-center text-sm font-medium text-start"},[e("span",{class:"flex-[3] pl-3"},"Auteur"),e("span",{class:"flex-[3] pl-3"}," Intention"),e("span",{class:"flex-[2] pl-3"}," Date"),e("span",{class:"flex-[2] pl-3"},"Heure "),e("span",{class:"flex-[2] pl-3"},"Type "),e("span",{class:"flex-[2] pl-3"}," Mode de paiement"),e("span",{class:"flex-[3] pl-3"},"Action")],-1),oe={class:"flex-[3] pl-3"},ae={class:"flex-[3] pl-3"},le={class:"flex-[2] pl-3"},ne={class:"flex-[2] pl-3"},re={class:"flex-[2] pl-3"},ue={class:"flex-[2] pl-3 capitalize"},de={class:"flex-[3] flex gap-3 text-white justify-start"},ie=["disabled","onClick"],me={key:1,class:"bg-[#b7b7b7] rounded-b-lg py-3 flex justify-evenly items-center text-sm font-medium text-start"},ce=["onSubmit"],pe=e("span",{class:"text-2xl font-medium"},"Renseigner une demande physique",-1),fe={class:"mt-4"},ve={class:"mt-4"},_e={class:"mt-4"},be={class:"mt-4"},ye=["value"],ge={class:"mt-4"},he=e("option",{value:"Simple"},"Simple",-1),xe=e("option",{value:"Neuvaine"},"Neuvaine",-1),we=e("option",{value:"Trentaine"},"Trentaine",-1),Ve=[he,xe,we],ke=e("br",null,null,-1),De={key:0,class:"text-slate-400"},Se={key:1,class:"text-slate-400"},Ce={key:2,class:"text-slate-400"},Ue={class:"mt-4"},Te={key:0,style:{"border-top-color":"transparent"},class:"ml-2 w-3 h-3 border-2 border-white border-solid rounded-full animate-spin"},Me=["onSubmit"],je=e("span",{class:"text-2xl font-medium"},"Modifier une demande physique",-1),Ne={class:"mt-4"},Re={class:"mt-4"},Le={class:"mt-4"},$e={class:"mt-4"},Fe=["value"],qe={class:"mt-4"},Ae=e("option",{value:"Simple"},"Simple",-1),Be=e("option",{value:"Neuvaine"},"Neuvaine",-1),Ee=e("option",{value:"Trentaine"},"Trentaine",-1),Ie=[Ae,Be,Ee],Oe=e("br",null,null,-1),ze={key:0,class:"text-slate-400"},He={key:1,class:"text-slate-400"},Pe={key:2,class:"text-slate-400"},Ze={class:"mt-4"},Ge={key:0,style:{"border-top-color":"transparent"},class:"ml-2 w-3 h-3 border-2 border-white border-solid rounded-full animate-spin"},lt={__name:"DemandeMessesView",props:{demandemesses:"",heures:""},setup(V){const U=V;let i=h(!1),b=h(!1),c=h("2023-01-01"),m=h("2024-01-01"),v=h([]),C=h([]),_=h([]),n=L({auteur:"",intention:"",date:"",heure:"",type:""}),l=L({id:"",intention:"",auteur:"",date:"",heure:"",type:""});L({id:""});const I=d=>{l.id=d.id,l.intention=d.intention,l.auteur=d.auteur=="Anonyme"?"":d.auteur,l.date=d.date,l.heure=d.heure,l.type=d.type,b.value=!0,R()},O=()=>{n.post(route("demandemesses.store"),{onSuccess:()=>{B.visit(route("demandemesses.index")),i.value=!1,n.reset()}})},z=()=>{l.auteur=l.auteur==""?"Anonyme":l.auteur,l.put(route("demandemesses.update",l),{onSuccess:()=>{B.visit(route("demandemesses.index")),l.reset(),b.value=!1}})},N=()=>{_.value=U.demandemesses.filter(d=>new Date(c.value)<=new Date(d.date)&&new Date(d.date)<=new Date(m.value))},H=()=>{for(let d of _.value)v.value.push({date:new Date(d.date).toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),intention:d.intention});X(v.value,"demandeMesses"+new Date().toLocaleDateString())},R=d=>{let o=d=="create"?new Date(n.date).getDay():new Date(l.date).getDay();o==0&&(o=7),C.value=U.heures.filter(t=>t.jour_id==o)};return Z(()=>{N()}),(d,o)=>(r(),u(T,null,[a(K,null,{default:x(()=>[a(s(G),{title:"Demandes de messe"}),e("div",Y,[a(j,{onClick:o[0]||(o[0]=t=>y(i)?i.value=!0:i=!0)},{default:x(()=>[k(" Renseigner une demande physique ")]),_:1}),V.demandemesses.length>0?(r(),u("button",{key:0,class:"inline-flex items-center px-4 py-2 bg-teal-800 border border-transparent rounded-md font-semibold text-xs text-white tracking-widest hover:bg-teal-700 focus:bg-teal-700 active:bg-teal-900 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-offset-2 transition ease-in-out duration-150",onClick:H}," Télécharger en csv ")):w("",!0),e("div",ee,[k(" Filtrer de "),a(S,{id:"date",modelValue:s(c),"onUpdate:modelValue":o[1]||(o[1]=t=>y(c)?c.value=t:c=t),type:"date",onChange:N},null,8,["modelValue"]),k(" à "),a(S,{id:"date",modelValue:s(m),"onUpdate:modelValue":o[2]||(o[2]=t=>y(m)?m.value=t:m=t),type:"date",onChange:N},null,8,["modelValue"]),a(j,{onClick:o[3]||(o[3]=()=>{y(_)?_.value=V.demandemesses:_=V.demandemesses,y(c)?c.value="2023-01-01":c="2023-01-01",y(m)?m.value="2024-01-01":m="2024-01-01"})},{default:x(()=>[k(" Supprimer le filtre ")]),_:1})]),e("ul",te,[se,s(_).length>0?(r(!0),u(T,{key:0},$(s(_),(t,P)=>(r(),u("li",{class:J(["py-2.5 flex justify- items-center text-sm font-medium hover:bg-[#b7b7b7] text-start",P%2==0?"bg-white":"bg-[#cecece]"])},[e("span",oe,g(t.auteur),1),e("span",ae,g(t.intention),1),e("span",le,g(new Date(t.date).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"})),1),e("span",ne,g(t.heure),1),e("span",re,g(t.type),1),e("span",ue,g(t.operateur?t.operateur:"Espèces"),1),e("div",de,[e("button",{disabled:t.paroissien_id,class:"bg-blue-700 py-2 px-4 self-start rounded-lg disabled:bg-gray-500 disabled:cursor-not-allowed",onClick:Je=>I(t)}," Modifier ",8,ie)])],2))),256)):(r(),u("li",me," Aucune demande de messe "))])])]),_:1}),a(E,{show:s(i),onClose:o[10]||(o[10]=t=>y(i)?i.value=!1:i=!1)},{default:x(()=>[e("form",{class:"p-10",onSubmit:A(O,["prevent"])},[pe,e("div",fe,[a(p,{for:"auteur",value:"Nom du demandeur (Laisser vide pour un don anonyme)"}),a(S,{id:"auteur",modelValue:s(n).auteur,"onUpdate:modelValue":o[4]||(o[4]=t=>s(n).auteur=t),type:"text",class:"mt-1 block w-full",autocomplete:"auteur"},null,8,["modelValue"]),a(f,{class:"mt-2",message:s(n).errors.auteur},null,8,["message"])]),e("div",ve,[a(p,{for:"intention",value:"Intention de messe"}),D(e("textarea",{"onUpdate:modelValue":o[5]||(o[5]=t=>s(n).intention=t),class:"border-gray-300 focus:border-blue-500 focus:ring-blue-500 rounded-md shadow-sm w-full",rows:"3"},null,512),[[F,s(n).intention]]),a(f,{class:"mt-2",message:s(n).errors.intention},null,8,["message"])]),e("div",_e,[a(p,{for:"date",value:"Date de la messe"}),a(S,{id:"date",modelValue:s(n).date,"onUpdate:modelValue":o[6]||(o[6]=t=>s(n).date=t),type:"date",onChange:o[7]||(o[7]=t=>R("create")),class:"mt-1 block w-full",required:"",autocomplete:"date"},null,8,["modelValue"]),a(f,{class:"mt-2",message:s(n).errors.date},null,8,["message"])]),e("div",be,[a(p,{for:"heure",value:"Heure de la messe"}),D(e("select",{class:"border-gray-300 focus:border-blue-500 focus:ring-blue-500 rounded-md shadow-sm","onUpdate:modelValue":o[8]||(o[8]=t=>s(n).heure=t)},[(r(!0),u(T,null,$(s(C),t=>(r(),u("option",{value:t.heureDebut},g(t.heureDebut),9,ye))),256))],512),[[M,s(n).heure]]),a(f,{class:"mt-2",message:s(n).errors.heure},null,8,["message"])]),e("div",ge,[a(p,{for:"type",value:"Type de demande de messe"}),D(e("select",{class:"border-gray-300 focus:border-blue-500 focus:ring-blue-500 rounded-md shadow-sm","onUpdate:modelValue":o[9]||(o[9]=t=>s(n).type=t)},Ve,512),[[M,s(n).type]]),a(f,{class:"mt-2",message:s(n).errors.type},null,8,["message"]),ke,s(n).type=="Simple"?(r(),u("span",De," 4 000 cfa")):w("",!0),s(n).type=="Neuvaine"?(r(),u("span",Se," 40 000 cfa")):w("",!0),s(n).type=="Trentaine"?(r(),u("span",Ce," 150 000 cfa")):w("",!0)]),e("div",Ue,[a(j,null,{default:x(()=>[k(" Valider "),s(n).processing?(r(),u("div",Te)):(r(),q(W,{key:1,size:20}))]),_:1})])],40,ce)]),_:1},8,["show"]),a(E,{show:s(b),onClose:o[17]||(o[17]=t=>y(b)?b.value=!1:b=!1)},{default:x(()=>[e("form",{class:"p-10",onSubmit:A(z,["prevent"])},[je,e("div",Ne,[a(p,{for:"auteur",value:"Nom du demandeur (Laisser vide pour un don anonyme)"}),a(S,{id:"auteur",modelValue:s(l).auteur,"onUpdate:modelValue":o[11]||(o[11]=t=>s(l).auteur=t),type:"text",class:"mt-1 block w-full",autocomplete:"auteur"},null,8,["modelValue"]),a(f,{class:"mt-2",message:s(n).errors.auteur},null,8,["message"])]),e("div",Re,[a(p,{for:"intention",value:"Intention de messe"}),D(e("textarea",{"onUpdate:modelValue":o[12]||(o[12]=t=>s(l).intention=t),class:"border-gray-300 focus:border-blue-500 focus:ring-blue-500 rounded-md shadow-sm w-full",rows:"3"},null,512),[[F,s(l).intention]]),a(f,{class:"mt-2",message:s(l).errors.intention},null,8,["message"])]),e("div",Le,[a(p,{for:"date",value:"Date de la messe"}),a(S,{id:"date",modelValue:s(l).date,"onUpdate:modelValue":o[13]||(o[13]=t=>s(l).date=t),type:"date",onChange:o[14]||(o[14]=t=>R("update")),class:"mt-1 block w-full",required:"",autocomplete:"date"},null,8,["modelValue"]),a(f,{class:"mt-2",message:s(l).errors.date},null,8,["message"])]),e("div",$e,[a(p,{for:"heure",value:"Heure de la messe"}),D(e("select",{class:"border-gray-300 focus:border-blue-500 focus:ring-blue-500 rounded-md shadow-sm","onUpdate:modelValue":o[15]||(o[15]=t=>s(l).heure=t)},[(r(!0),u(T,null,$(s(C),t=>(r(),u("option",{value:t.heureDebut},g(t.heureDebut),9,Fe))),256))],512),[[M,s(l).heure]]),a(f,{class:"mt-2",message:s(l).errors.heure},null,8,["message"])]),e("div",qe,[a(p,{for:"type",value:"Type de demande de messe"}),D(e("select",{class:"border-gray-300 focus:border-blue-500 focus:ring-blue-500 rounded-md shadow-sm","onUpdate:modelValue":o[16]||(o[16]=t=>s(l).type=t)},Ie,512),[[M,s(l).type]]),a(f,{class:"mt-2",message:s(l).errors.type},null,8,["message"]),Oe,s(l).type=="Simple"?(r(),u("span",ze," 4000 cfa")):w("",!0),s(l).type=="Neuvaine"?(r(),u("span",He," 40000 cfa")):w("",!0),s(l).type=="Trentaine"?(r(),u("span",Pe," 150000 cfa")):w("",!0)]),e("div",Ze,[a(j,null,{default:x(()=>[k(" Modifier "),s(l).processing?(r(),u("div",Ge)):(r(),q(Q,{key:1,size:20}))]),_:1})])],40,Me)]),_:1},8,["show"])],64))}};export{lt as default};
